
# Machine Learning Classification of Neutron Star Equations of State

![Python](https://img.shields.io/badge/Python-3.10%2B-blue)
![Status](https://img.shields.io/badge/Status-Thesis%20Complete-orange)

**Author:** Ioannis Papathanasiou  
**Institution:** Aristotle University of Thessaloniki (AUTH)  
**Department:** Theoretical Physics  
**Thesis Supervisor:** Theodoros Diakonidis and Charalampos Moustakidis

---

## 1. Abstract
This repository contains the source code for the computational pipeline developed for **Chapter 6** of my Bachelor's Thesis. The objective is to classify Neutron Star Equations of State (EoS) into two distinct physical families: **Hadronic** (standard nuclear matter) and **Quark** (exotic matter, specifically CSS stars), based on macroscopic observables.

The pipeline integrates General Relativistic solvers (TOV equations) with Machine Learning to:
1.  **Generate** synthetic stellar populations adhering to strict astrophysical priors (GW170817, PSR J0740+6620).
2.  **Train** a Random Forest Classifier to distinguish microphysics based on Mass ($M$), Radius ($R$), and Tidal Deformability ($\Lambda$).
3.  **Infer** the nature of real astrophysical candidates, identifying potential Quark Star candidates.

## 2. Key Results (Inference)
The trained model was applied to a set of observational candidates. Monte Carlo sampling was used to propagate observational uncertainties through the classifier. The inference identifies **HESS J1731-347** as a statistically significant candidate for a Quark Star, while **GW170817** remains consistent with both models.

| Candidate Object | Mass ($M_{\odot}$) | Radius (km) | P(Quark) | Verdict |
| :--- | :--- | :--- | :--- | :--- |
| **GW170817** | $1.40 \pm 0.10$ | $11.90 \pm 1.40$ | **58.6%** | Ambiguous |
| **HESS J1731-347** | $0.77 \pm 0.17$ | $10.40 \pm 0.78$ | **95.3%** | **QUARK** |
| **PSR J0740+6620** | $2.08 \pm 0.07$ | $12.35 \pm 0.75$ | 32.6% | Hadronic |
| **PSR J0030+04** | $1.44 \pm 0.15$ | $13.02 \pm 1.06$ | 22.4% | Hadronic |

## 3. Physics & Methodology

### Data Generation (The "Physics Manifold")
The dataset is generated by solving the Tolman-Oppenheimer-Volkoff (TOV) equations for parameterized EoS models.

*   **Hadronic EoS (Class 0):** Constructed via **Logarithmic Mixing** of 21 analytic nuclear models (e.g., Skyrme, RMF) combined with homologous scaling.
    *   *Priors Enforced:*
        *   $R_{1.4} \geq 11.0$ km (Nuclear physics lower bound)
        *   $\Lambda_{1.4} \leq 580$ (GW170817 constraint)
        *   $M_{max} \geq 1.97 M_{\odot}$ (PSR J0740+6620 stability)
*   **Quark EoS (Class 1):** Modeled using the **Constant Speed of Sound (CSS)** framework with a variable Bag Constant.
    *   *Parameter Space:* $c_s^2 \in [0.33, 1.0]$, $B \in [40, 90]$ MeV/fm$^3$.
    *   *Constraints:* $R_{max} < 12.5$ km.

### Machine Learning Architecture
*   **Model:** Random Forest Classifier ($N_{estimators}=200$, Max Depth=12).
*   **Validation Strategy:** **Group-Shuffle-Split** ($N=5$).
    *   *Why?* Standard K-Fold leaks data in manifold learning. We group by `Curve_ID` to ensure no two points from the same EoS curve exist simultaneously in training and test sets.
*   **Metrics:**
    *   AUC Score: **0.995**
    *   Global Accuracy: **97%**

## 4. Visualizations

### The Physical Manifold
Figure 1 visualizes the synthetic populations. The Left panel ($M-R$) shows the "Gap" at low masses ($< 1.0 M_{\odot}$) where Quark models (Red) exist but Hadronic models (Blue) do not. The Right panel displays the linear Equation of State comparison ($P$ vs $\epsilon$).

![alt text](Thesis_Code/plots/fig_physics_manifold.png)

### Model Diagnostics
Figure 2 (Top) shows the Confusion Matrix, highlighting minimal false positives. Figure 2 (Below) shows the ROC curve approaching the ideal corner.
![alt text](plots/fig_ml_diagnostics.png)
![alt text](plots/fig_violin_physics.png)

## 5. Installation & Usage

### Prerequisites
*   Python 3.10+
*   Standard scientific stack (`numpy`, `scipy`, `pandas`, `scikit-learn`, `joblib`)

### Setup
```bash
# Clone the repository
git clone https://github.com/PapathanasiouIoannis/neutron_ml.git
cd neutron_ml

# Install dependencies
pip install -r requirements.txt
```

### Execution
To reproduce the full pipeline (Data Generation $\to$ Training $\to$ Visualization):

```bash
python main.py
```
*Note: The first run generates ~4,000 synthetic stars and may take 20-40 minutes depending on CPU cores (parallelized via `joblib`). Subsequent runs will load the CSV from disk.*

## 6. Repository Structure

```text
neutron_ml/
├── data/               # Generated synthetic dataset (thesis_dataset.csv)
├── plots/              # Output directory for high-res figures
├── src/
│   ├── const.py        # Physical constants (G, M_sun) and priors
│   ├── physics.py      # TOV solver, EoS libraries, and parallel workers
│   ├── ml_pipeline.py  # RF training, GroupKFold, and Monte Carlo inference
│   └── visualize.py    # Plotting engines (Manifolds, Violins, ROC)
├── main.py             # Pipeline orchestrator
├── requirements.txt    # Dependency list
└── README.md           # Project documentation
```

